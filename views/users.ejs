<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <meta charset="UTF-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1">
   

    <link rel="icon" type="image/png" href="/images/icons/favicon.ico"/>
   
      <link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">

      <link rel="stylesheet" type="text/css" href="/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
   
      <link rel="stylesheet" type="text/css" href="/vendor/animate/animate.css">
  
      <link rel="stylesheet" type="text/css" href="/vendor/css-hamburgers/hamburgers.min.css">
   
      <link rel="stylesheet" type="text/css" href="/vendor/select2/select2.min.css">
 
      <link rel="stylesheet" type="text/css" href="/stylesheets/util.css">
      <link rel="stylesheet" type="text/css" href="/stylesheets/main.css">

      <script src="/socket.io/socket.io.js"></script>
      <script src="/routes/roomservice.js"></script>
     
  </head>
  <body>


    <div class="limiter">
      <div class="container-login100">
        <div class="wrap-login100">

          <div class="login100-pic js-tilt" data-tilt>
            <h4>JusTalk</h4>
            <img src="/images/img-01.png" alt="IMG">
          </div>
        
          <div class="col-md-6">

             <div class="alert alert-success">Welcome to JusTalk   <strong><%= name %> !</strong> </div>
             <br><br>
             <div class="well">
              <button type="button" class="btn btn-success" id="usersview">Users</button> &nbsp;
              <button type="button" class="btn btn-primary" id="roomsview">Join Chat</button> &nbsp;
              <button type="button" class="btn btn-danger" id="createRoom">Start New</button>
             </div>
              <div class="well" id="userlist">
                  <h3>Online Users</h3><br>
                  <ul class="list-group" id="users"></ul> 
              
              </div>
              <div class="well" id="room-container" style="display: none">
                <h3>Available Rooms</h3><br> 
               <% Object.keys(rooms).forEach(room =>{ %>
              <div><%= room %> &nbsp;
              <button  class="btn btn-primary" onclick="window.location = '/chatRoom/<%= room %>?username=<%= name %>';">Chat</button>
              </div> 
                <% }) %>
            </div>
            <div  class="well" id="room-create" style="display: none">
              <h3>Create Chat Room</h3><br> 
              <form action="/chatRoom/room" id="roomform" method="POST">
                <input name="room" id="roomname" type="text" value="<%= name %>" style="display: none">&nbsp;
                <button class="btn btn-danger" type="submit">Create new</button>
                </form>
              </div>
 
      </div>
    

        </div>
      </div>
    </div>
    
  
    
	
    <script src="/vendor/jquery/jquery-3.2.1.min.js"></script>

    <script src="/vendor/bootstrap/js/popper.js"></script>
    <script src="/vendor/bootstrap/js/bootstrap.min.js"></script>

    <script src="/vendor/select2/select2.min.js"></script>

    <script src="/vendor/tilt/tilt.jquery.min.js"></script>

    <script>
    $(function(){

     var $usrbtn = $('#usersview');
     var $roombtn = $('#roomsview');
    
     $usrbtn.click(function(){
      $('#room-container').hide();
      $('#userlist').show();

     });
     $roombtn.click(function(){
      $('#userlist').hide();
      $('#room-container').show();
     });
     
     });
    </script>
 


    <div id="mydiv" data-test=<%= name %>></div>
    <script>
    var username = document.getElementById('mydiv').dataset.test
   $(function(){
        var socket = io.connect();
        var $users = $('#users');
        var $createroom = $('#createRoom');
        var $roomform = $('#room-create');
  
        socket.emit('new user',username , function(data){
                });

        socket.on('get users', function(data){
                var html = '';
                for(i = 0; i< data.length; i++){
                    
                       var x = username.localeCompare(data[i]); 
                       if(x==0) {
                        html +=   '<li class="list-group-item">'  +data[i]+'(You)   </li>' 
                      }
                               else{ 
                                html +=   '<li class="list-group-item">'  +data[i]+' </li>' 
                                  }
                              
                }
                $users.html(html);
            });

           
           $createroom.click(function(){
             $roomform.show();
       
     });

        
     });
    </script>

 
    
  
    

    <script>
     $('.js-tilt').tilt({
        scale: 1.1
      });
      </script>

    <script src="/javascripts/main.js"></script>

  
  </body>
</html>
